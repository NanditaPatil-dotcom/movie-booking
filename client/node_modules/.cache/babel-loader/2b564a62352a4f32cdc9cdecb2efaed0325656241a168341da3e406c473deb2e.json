{"ast":null,"code":"import axios from 'axios';\n\n// Create axios instance with base configuration\nconst api = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || '/api',\n  timeout: 10000\n});\n\n// Request interceptor to add auth token\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('authToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n    console.log('[API] Adding auth token to request:', config.url);\n  } else {\n    console.log('[API] No auth token found for request:', config.url);\n  }\n  return config;\n}, error => {\n  console.error('[API] Request interceptor error:', error);\n  return Promise.reject(error);\n});\n\n// Response interceptor to handle 401s\napi.interceptors.response.use(response => {\n  return response;\n}, error => {\n  const {\n    response\n  } = error;\n  if ((response === null || response === void 0 ? void 0 : response.status) === 401) {\n    console.log('[API] 401 response received, checking if user was authenticated...');\n\n    // Check if user was previously authenticated\n    const token = localStorage.getItem('authToken');\n    const currentUser = localStorage.getItem('currentUser');\n    if (token && currentUser) {\n      console.log('[API] User was authenticated but got 401 - token likely expired, logging out');\n\n      // Clear auth data\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('currentUser');\n\n      // Reload page to reset auth state (or dispatch logout if using context)\n      // For now, we'll reload to ensure clean state\n      window.location.href = '/signin';\n      return Promise.reject(error);\n    } else {\n      console.log('[API] User was not authenticated, 401 is expected');\n    }\n  }\n  console.error('[API] Response error:', response === null || response === void 0 ? void 0 : response.status, error.message);\n  return Promise.reject(error);\n});\nexport default api;","map":{"version":3,"names":["axios","api","create","baseURL","process","env","REACT_APP_API_URL","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","console","log","url","error","Promise","reject","response","status","currentUser","removeItem","window","location","href","message"],"sources":["/home/nandita/Downloads/movie-booking/client/src/utils/axios.js"],"sourcesContent":["import axios from 'axios'\n\n// Create axios instance with base configuration\nconst api = axios.create({\n  baseURL: process.env.REACT_APP_API_URL || '/api',\n  timeout: 10000,\n})\n\n// Request interceptor to add auth token\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('authToken')\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n      console.log('[API] Adding auth token to request:', config.url)\n    } else {\n      console.log('[API] No auth token found for request:', config.url)\n    }\n    return config\n  },\n  (error) => {\n    console.error('[API] Request interceptor error:', error)\n    return Promise.reject(error)\n  }\n)\n\n// Response interceptor to handle 401s\napi.interceptors.response.use(\n  (response) => {\n    return response\n  },\n  (error) => {\n    const { response } = error\n\n    if (response?.status === 401) {\n      console.log('[API] 401 response received, checking if user was authenticated...')\n\n      // Check if user was previously authenticated\n      const token = localStorage.getItem('authToken')\n      const currentUser = localStorage.getItem('currentUser')\n\n      if (token && currentUser) {\n        console.log('[API] User was authenticated but got 401 - token likely expired, logging out')\n\n        // Clear auth data\n        localStorage.removeItem('authToken')\n        localStorage.removeItem('currentUser')\n\n        // Reload page to reset auth state (or dispatch logout if using context)\n        // For now, we'll reload to ensure clean state\n        window.location.href = '/signin'\n        return Promise.reject(error)\n      } else {\n        console.log('[API] User was not authenticated, 401 is expected')\n      }\n    }\n\n    console.error('[API] Response error:', response?.status, error.message)\n    return Promise.reject(error)\n  }\n)\n\nexport default api"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA,MAAMC,GAAG,GAAGD,KAAK,CAACE,MAAM,CAAC;EACvBC,OAAO,EAAEC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,MAAM;EAChDC,OAAO,EAAE;AACX,CAAC,CAAC;;AAEF;AACAN,GAAG,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CACzBC,MAAM,IAAK;EACV,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;EAC/C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAG,UAAUJ,KAAK,EAAE;IAChDK,OAAO,CAACC,GAAG,CAAC,qCAAqC,EAAEP,MAAM,CAACQ,GAAG,CAAC;EAChE,CAAC,MAAM;IACLF,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAEP,MAAM,CAACQ,GAAG,CAAC;EACnE;EACA,OAAOR,MAAM;AACf,CAAC,EACAS,KAAK,IAAK;EACTH,OAAO,CAACG,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;EACxD,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAnB,GAAG,CAACO,YAAY,CAACe,QAAQ,CAACb,GAAG,CAC1Ba,QAAQ,IAAK;EACZ,OAAOA,QAAQ;AACjB,CAAC,EACAH,KAAK,IAAK;EACT,MAAM;IAAEG;EAAS,CAAC,GAAGH,KAAK;EAE1B,IAAI,CAAAG,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEC,MAAM,MAAK,GAAG,EAAE;IAC5BP,OAAO,CAACC,GAAG,CAAC,oEAAoE,CAAC;;IAEjF;IACA,MAAMN,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC;IAC/C,MAAMW,WAAW,GAAGZ,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;IAEvD,IAAIF,KAAK,IAAIa,WAAW,EAAE;MACxBR,OAAO,CAACC,GAAG,CAAC,8EAA8E,CAAC;;MAE3F;MACAL,YAAY,CAACa,UAAU,CAAC,WAAW,CAAC;MACpCb,YAAY,CAACa,UAAU,CAAC,aAAa,CAAC;;MAEtC;MACA;MACAC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,SAAS;MAChC,OAAOR,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;IAC9B,CAAC,MAAM;MACLH,OAAO,CAACC,GAAG,CAAC,mDAAmD,CAAC;IAClE;EACF;EAEAD,OAAO,CAACG,KAAK,CAAC,uBAAuB,EAAEG,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEC,MAAM,EAAEJ,KAAK,CAACU,OAAO,CAAC;EACvE,OAAOT,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AAED,eAAenB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}