{"ast":null,"code":"import{useState,useEffect}from'react';import{useNavigate,Link,useLocation}from'react-router-dom';import axios from'axios';import{Button}from'../components/ui/Button';import{Navigation}from'../components/Navigation';import{useAuth}from'../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function SignIn(){const colors={red:'#BD292C',white:'#FFFFFF',light:'#D9D9D9',gray:'#3F3B3B'};const navigate=useNavigate();const location=useLocation();const{login}=useAuth();const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[loading,setLoading]=useState(false);const[error,setError]=useState('');// Get redirect path from query params\nconst queryParams=new URLSearchParams(location.search);const redirectPath=queryParams.get('redirect')||'/';const onSubmit=async e=>{e.preventDefault();setError('');setLoading(true);try{const res=await axios.post('/api/auth/login',{email,password});const{user,token}=res.data;// Use the auth context login method\nlogin(token,user);// Check for pending booking and restore it\nconst{getBookingPayload,clearBookingPayload}=await import('../utils/bookingStorage');const pendingBooking=getBookingPayload();if(pendingBooking){// Clear the stored booking after restoring\nclearBookingPayload();// Navigate to the redirect path (which should be the seats page)\nnavigate(redirectPath);}else{// No pending booking, go to redirect path or home\nnavigate(redirectPath);}}catch(err){var _err$response,_err$response$data;const msg=(err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Login failed';setError(msg);}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"main\",{style:{minHeight:'100vh',backgroundColor:colors.light,color:colors.gray},children:[/*#__PURE__*/_jsx(Navigation,{}),/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:'64rem',margin:'0 auto',padding:'2rem 1rem'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'flex-end',marginBottom:'1rem'},children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",children:\"Back to home\"})})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',maxWidth:'28rem',backgroundColor:colors.white,borderRadius:'0.5rem',border:\"1px solid \".concat(colors.gray,\"22\"),boxShadow:'0 1px 2px rgba(0,0,0,0.04)',padding:'1.5rem'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:'center',fontSize:'1.5rem',fontWeight:800,marginBottom:'1rem',color:colors.gray},children:\"Welcome Back\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:'0.875rem',marginBottom:'0.25rem'},children:\"Email:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:email,onChange:e=>setEmail(e.target.value),required:true,style:{width:'100%',height:'2.5rem',borderRadius:'0.5rem',padding:'0 0.75rem',border:\"1px solid \".concat(colors.gray,\"33\"),backgroundColor:colors.white,color:colors.gray,marginBottom:'0.75rem'}}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',fontSize:'0.875rem',marginBottom:'0.25rem'},children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,style:{width:'100%',height:'2.5rem',borderRadius:'0.5rem',padding:'0 0.75rem',border:\"1px solid \".concat(colors.gray,\"33\"),backgroundColor:colors.white,color:colors.gray,marginBottom:'0.75rem'}}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:colors.red,fontSize:'0.875rem',marginBottom:'0.5rem'},children:error}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',margin:'0.75rem 0 1rem',fontSize:'0.875rem'},children:[\"Don't have an account?\",' ',/*#__PURE__*/_jsx(Link,{to:\"/signup\",style:{color:colors.red,textDecoration:'none',fontWeight:600},children:\"Sign Up\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",size:\"lg\",style:{width:'100%'},disabled:loading,children:loading?'Logging in...':'Login'})]})]})})]})]});}","map":{"version":3,"names":["useState","useEffect","useNavigate","Link","useLocation","axios","Button","Navigation","useAuth","jsx","_jsx","jsxs","_jsxs","SignIn","colors","red","white","light","gray","navigate","location","login","email","setEmail","password","setPassword","loading","setLoading","error","setError","queryParams","URLSearchParams","search","redirectPath","get","onSubmit","e","preventDefault","res","post","user","token","data","getBookingPayload","clearBookingPayload","pendingBooking","err","_err$response","_err$response$data","msg","response","message","style","minHeight","backgroundColor","color","children","maxWidth","margin","padding","display","justifyContent","marginBottom","to","variant","size","width","borderRadius","border","concat","boxShadow","textAlign","fontSize","fontWeight","type","value","onChange","target","required","height","textDecoration","disabled"],"sources":["/home/nandita/Downloads/movie-booking/client/src/pages/SignIn.jsx"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport { useNavigate, Link, useLocation } from 'react-router-dom'\nimport axios from 'axios'\nimport { Button } from '../components/ui/Button'\nimport { Navigation } from '../components/Navigation'\nimport { useAuth } from '../contexts/AuthContext'\n\nexport default function SignIn() {\n  const colors = {\n    red: '#BD292C',\n    white: '#FFFFFF',\n    light: '#D9D9D9',\n    gray: '#3F3B3B'\n  }\n\n  const navigate = useNavigate()\n  const location = useLocation()\n  const { login } = useAuth()\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n\n  // Get redirect path from query params\n  const queryParams = new URLSearchParams(location.search)\n  const redirectPath = queryParams.get('redirect') || '/'\n\n  const onSubmit = async (e) => {\n    e.preventDefault()\n    setError('')\n    setLoading(true)\n    try {\n      const res = await axios.post('/api/auth/login', { email, password })\n      const { user, token } = res.data\n\n      // Use the auth context login method\n      login(token, user)\n\n      // Check for pending booking and restore it\n      const { getBookingPayload, clearBookingPayload } = await import('../utils/bookingStorage')\n      const pendingBooking = getBookingPayload()\n\n      if (pendingBooking) {\n        // Clear the stored booking after restoring\n        clearBookingPayload()\n        // Navigate to the redirect path (which should be the seats page)\n        navigate(redirectPath)\n      } else {\n        // No pending booking, go to redirect path or home\n        navigate(redirectPath)\n      }\n    } catch (err) {\n      const msg = err?.response?.data?.message || 'Login failed'\n      setError(msg)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <main style={{ minHeight: '100vh', backgroundColor: colors.light, color: colors.gray }}>\n      <Navigation />\n\n      <div style={{ maxWidth: '64rem', margin: '0 auto', padding: '2rem 1rem' }}>\n        <div style={{ display: 'flex', justifyContent: 'flex-end', marginBottom: '1rem' }}>\n          <Link to=\"/\">\n            <Button variant=\"outline\" size=\"sm\">Back to home</Button>\n          </Link>\n        </div>\n\n        <div style={{ display: 'flex', justifyContent: 'center' }}>\n          <div\n            style={{\n              width: '100%',\n              maxWidth: '28rem',\n              backgroundColor: colors.white,\n              borderRadius: '0.5rem',\n              border: `1px solid ${colors.gray}22`,\n              boxShadow: '0 1px 2px rgba(0,0,0,0.04)',\n              padding: '1.5rem'\n            }}\n          >\n            <h2 style={{ textAlign: 'center', fontSize: '1.5rem', fontWeight: 800, marginBottom: '1rem', color: colors.gray }}>\n              Welcome Back\n            </h2>\n\n            <form onSubmit={onSubmit}>\n              <label style={{ display: 'block', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Email:</label>\n              <input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                style={{\n                  width: '100%',\n                  height: '2.5rem',\n                  borderRadius: '0.5rem',\n                  padding: '0 0.75rem',\n                  border: `1px solid ${colors.gray}33`,\n                  backgroundColor: colors.white,\n                  color: colors.gray,\n                  marginBottom: '0.75rem'\n                }}\n              />\n\n              <label style={{ display: 'block', fontSize: '0.875rem', marginBottom: '0.25rem' }}>Password:</label>\n              <input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                style={{\n                  width: '100%',\n                  height: '2.5rem',\n                  borderRadius: '0.5rem',\n                  padding: '0 0.75rem',\n                  border: `1px solid ${colors.gray}33`,\n                  backgroundColor: colors.white,\n                  color: colors.gray,\n                  marginBottom: '0.75rem'\n                }}\n              />\n\n              {error && (\n                <div style={{ color: colors.red, fontSize: '0.875rem', marginBottom: '0.5rem' }}>{error}</div>\n              )}\n\n              <div style={{ textAlign: 'center', margin: '0.75rem 0 1rem', fontSize: '0.875rem' }}>\n                Don't have an account?{' '}\n                <Link to=\"/signup\" style={{ color: colors.red, textDecoration: 'none', fontWeight: 600 }}>Sign Up</Link>\n              </div>\n\n              <Button type=\"submit\" size=\"lg\" style={{ width: '100%' }} disabled={loading}>\n                {loading ? 'Logging in...' : 'Login'}\n              </Button>\n            </form>\n          </div>\n        </div>\n      </div>\n    </main>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}